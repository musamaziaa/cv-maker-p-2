<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Create Resume - AI-Powered CV Maker</title>
    <meta name="description"
        content="Build your professional resume with AI assistance. Create, edit, and generate CV content with our intelligent resume builder.">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/svg+xml" href="assets/images/favicon.svg">
    <link rel="icon" type="image/png" href="assets/images/favicon.png">
    <link rel="apple-touch-icon" href="assets/images/favicon.png">

    <!-- custom css -->
    <link rel="stylesheet" href="assets/css/main.css">
</head>

<body>
    <nav class="navbar bg-white">
        <div class="container">
            <div class="navbar-content" style="display: flex; justify-content: space-between; align-items: center;">
                <div class="brand-and-toggler">
                    <a href="index.html" class="navbar-brand">
                        <img src="assets/images/curriculum-vitae.png" alt="" class="navbar-brand-icon">
                        <span class="navbar-brand-text">AI-Powered <span>CV Maker</span></span>
                    </a>
                </div>
                <div class="navbar-auth-links">
                    <a href="log-in.html" class="btn btn-secondary" style="margin-right: 8px;">Log in</a>
                    <a href="sign-up.html" class="btn btn-primary">Sign up</a>
                </div>
            </div>
        </div>
    </nav>

    <section id="about-sc" class="">
        <div class="container">
            <div class="about-cnt">
                <form action="" class="cv-form" id="cv-form">
                    <div class="cv-form-blk">
                        <div class="cv-form-row-title">
                            <h3>about section</h3>
                        </div>
                        <div class="cv-form-row cv-form-row-about">
                            <div class="cols-3">
                                <div class="form-elem">
                                    <label for="" class="form-label">First Name</label>
                                    <input name="firstname" type="text" class="form-control firstname" id=""
                                        onkeyup="generateCV()" placeholder="e.g. Muhammad">
                                    <span class="form-text"></span>
                                </div>
                                <div class="form-elem">
                                    <label for="" class="form-label">Middle Name <span
                                            class="opt-text">(optional)</span></label>
                                    <input name="middlename" type="text" class="form-control middlename" id=""
                                        onkeyup="generateCV()" placeholder="e.g. Usama">
                                    <span class="form-text"></span>
                                </div>
                                <div class="form-elem">
                                    <label for="" class="form-label">Last Name</label>
                                    <input name="lastname" type="text" class="form-control lastname" id=""
                                        onkeyup="generateCV()" placeholder="e.g. Zia">
                                    <span class="form-text"></span>
                                </div>
                            </div>

                            <div class="cols-3">
                                <div class="form-elem">
                                    <label for="" class="form-label">Your Image</label>
                                    <input name="image" type="file" class="form-control image" id="" accept="image/*"
                                        onchange="previewImage()">
                                </div>
                                <div class="form-elem">
                                    <label for="" class="form-label">Designation</label>
                                    <input name="designation" type="text" class="form-control designation" id=""
                                        onkeyup="generateCV()" placeholder="e.g. Sr.Accountants">
                                    <span class="form-text"></span>
                                </div>
                                <div class="form-elem">
                                    <label for="" class="form-label">Address</label>
                                    <input name="address" type="text" class="form-control address" id=""
                                        onkeyup="generateCV()" placeholder="e.g. Lake Street-23">
                                    <span class="form-text"></span>
                                </div>
                            </div>

                            <div class="cols-3">
                                <div class="form-elem">
                                    <label for="" class="form-label">Email</label>
                                    <input name="email" type="text" class="form-control email" id=""
                                        onkeyup="generateCV()" placeholder="e.g. johndoe@gmail.com">
                                    <span class="form-text"></span>
                                </div>
                                <div class="form-elem">
                                    <label for="" class="form-label">Phone No:</label>
                                    <input name="phoneno" type="text" class="form-control phoneno" id=""
                                        onkeyup="generateCV()" placeholder="e.g. 456-768-798, 567.654.002">
                                    <span class="form-text"></span>
                                </div>
                                <div class="form-elem">
                                    <label for="" class="form-label">Summary</label>
                                    <input name="summary" type="text" class="form-control summary" id=""
                                        onkeyup="generateCV()" placeholder="e.g. Doe">
                                    <span class="form-text"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="cv-form-blk">
                        <div class="cv-form-row-title">
                            <h3>achievements</h3>
                        </div>

                        <div class="row-separator repeater">
                            <div class="repeater" data-repeater-list="group-a">
                                <div data-repeater-item>
                                    <div class="cv-form-row cv-form-row-achievement">
                                        <div class="cols-2">
                                            <div class="form-elem">
                                                <label for="" class="form-label">Title</label>
                                                <input name="achieve_title" type="text"
                                                    class="form-control achieve_title" id="" onkeyup="generateCV()" lt
                                                    placeholder="e.g. Became a manager at Google">
                                                <span class="form-text"></span>
                                            </div>
                                            <div class="form-elem">
                                                <label for="" class="form-label">Description</label>
                                                <textarea name="achieve_description"
                                                    class="form-control achieve_description" id=""
                                                    onkeyup="generateCV()"
                                                    placeholder="e.g. I was a manager at Google for 2 years." rows="6"
                                                    style="resize: vertical; min-height: 120px; font-family: inherit; line-height: 1.4;"></textarea>
                                                <span class="form-text"></span>
                                                <button type="button" class="btn btn-primary ai-generate-btn"
                                                    onclick="generateAchievementPointsWithAI(this)"
                                                    style="margin-top: 8px; font-size: 1.2rem; padding: 0.6rem 1.2rem;">
                                                    Generate Points Using AI
                                                </button>
                                            </div>
                                        </div>
                                        <button data-repeater-delete type="button"
                                            class="repeater-remove-btn">-</button>
                                    </div>
                                </div>
                            </div>
                            <button type="button" data-repeater-create value="Add" class="repeater-add-btn">+</button>
                        </div>
                    </div>

                    <div class="cv-form-blk">
                        <div class="cv-form-row-title">
                            <h3>experience</h3>
                        </div>

                        <div class="row-separator repeater">
                            <div class="repeater" data-repeater-list="group-b">
                                <div data-repeater-item>
                                    <div class="cv-form-row cv-form-row-experience">
                                        <div class="cols-3">
                                            <div class="form-elem">
                                                <label for="" class="form-label">Title</label>
                                                <input name="exp_title" type="text" class="form-control exp_title" id=""
                                                    onkeyup="generateCV()">
                                                <span class="form-text"></span>
                                            </div>
                                            <div class="form-elem">
                                                <label for="" class="form-label">Company / Organization</label>
                                                <input name="exp_organization" type="text"
                                                    class="form-control exp_organization" id="" onkeyup="generateCV()">
                                                <span class="form-text"></span>
                                            </div>
                                            <div class="form-elem">
                                                <label for="" class="form-label">Location</label>
                                                <input name="exp_location" type="text" class="form-control exp_location"
                                                    id="" onkeyup="generateCV()">
                                                <span class="form-text"></span>
                                            </div>
                                        </div>

                                        <div class="cols-3">
                                            <div class="form-elem">
                                                <label for="" class="form-label">Start Date</label>
                                                <input name="exp_start_date" type="date"
                                                    class="form-control exp_start_date" id="" onkeyup="generateCV()">
                                                <span class="form-text"></span>
                                            </div>
                                            <div class="form-elem">
                                                <label for="" class="form-label">End Date</label>
                                                <input name="exp_end_date" type="date" class="form-control exp_end_date"
                                                    id="" onkeyup="generateCV()">
                                                <span class="form-text"></span>
                                            </div>
                                            <div class="form-elem">
                                                <label for="" class="form-label">Description</label>
                                                <textarea name="exp_description" class="form-control exp_description"
                                                    id="" onkeyup="generateCV()"
                                                    placeholder="e.g. Describe your responsibilities and achievements in this role."
                                                    rows="6"
                                                    style="resize: vertical; min-height: 120px; font-family: inherit; line-height: 1.4;"></textarea>
                                                <span class="form-text"></span>
                                                <button type="button" class="btn btn-primary ai-generate-btn"
                                                    onclick="generateExperiencePointsWithAI(this)"
                                                    style="margin-top: 8px; font-size: 1.2rem; padding: 0.6rem 1.2rem;">
                                                    Generate Points Using AI
                                                </button>
                                            </div>
                                        </div>

                                        <button data-repeater-delete type="button"
                                            class="repeater-remove-btn">-</button>
                                    </div>
                                </div>
                            </div>
                            <button type="button" data-repeater-create value="Add" class="repeater-add-btn">+</button>
                        </div>
                    </div>

                    <div class="cv-form-blk">
                        <div class="cv-form-row-title">
                            <h3>education</h3>
                        </div>

                        <div class="row-separator repeater">
                            <div class="repeater" data-repeater-list="group-c">
                                <div data-repeater-item>
                                    <div class="cv-form-row cv-form-row-experience">
                                        <div class="cols-3">
                                            <div class="form-elem">
                                                <label for="" class="form-label">School</label>
                                                <input name="edu_school" type="text" class="form-control edu_school"
                                                    id="" onkeyup="generateCV()">
                                                <span class="form-text"></span>
                                            </div>
                                            <div class="form-elem">
                                                <label for="" class="form-label">Degree</label>
                                                <input name="edu_degree" type="text" class="form-control edu_degree"
                                                    id="" onkeyup="generateCV()">
                                                <span class="form-text"></span>
                                            </div>
                                            <div class="form-elem">
                                                <label for="" class="form-label">City</label>
                                                <input name="edu_city" type="text" class="form-control edu_city" id=""
                                                    onkeyup="generateCV()">
                                                <span class="form-text"></span>
                                            </div>
                                        </div>

                                        <div class="cols-3">
                                            <div class="form-elem">
                                                <label for="" class="form-label">Start Date</label>
                                                <input name="edu_start_date" type="date"
                                                    class="form-control edu_start_date" id="" onkeyup="generateCV()">
                                                <span class="form-text"></span>
                                            </div>
                                            <div class="form-elem">
                                                <label for="" class="form-label">End Date</label>
                                                <input name="edu_graduation_date" type="date"
                                                    class="form-control edu_graduation_date" id=""
                                                    onkeyup="generateCV()">
                                                <span class="form-text"></span>
                                            </div>
                                            <div class="form-elem">
                                                <label for="" class="form-label">Description</label>
                                                <textarea name="edu_description" class="form-control edu_description"
                                                    id="" onkeyup="generateCV()"
                                                    placeholder="e.g. Describe your academic achievements, projects, and activities."
                                                    rows="6"
                                                    style="resize: vertical; min-height: 120px; font-family: inherit; line-height: 1.4;"></textarea>
                                                <span class="form-text"></span>
                                                <button type="button" class="btn btn-primary ai-generate-btn"
                                                    onclick="generateEducationPointsWithAI(this)"
                                                    style="margin-top: 8px; font-size: 1.2rem; padding: 0.6rem 1.2rem;">
                                                    Generate Points Using AI
                                                </button>
                                            </div>
                                        </div>

                                        <button data-repeater-delete type="button"
                                            class="repeater-remove-btn">-</button>
                                    </div>
                                </div>
                            </div>
                            <button type="button" data-repeater-create value="Add" class="repeater-add-btn">+</button>
                        </div>
                    </div>

                    <div class="cv-form-blk">
                        <div class="cv-form-row-title">
                            <h3>projects</h3>
                        </div>

                        <div class="row-separator repeater">
                            <div class="repeater" data-repeater-list="group-d">
                                <div data-repeater-item>
                                    <div class="cv-form-row cv-form-row-experience">
                                        <div class="cols-3">
                                            <div class="form-elem">
                                                <label for="" class="form-label">Project Name</label>
                                                <input name="proj_title" type="text" class="form-control proj_title"
                                                    id="" onkeyup="generateCV()">
                                                <span class="form-text"></span>
                                            </div>
                                            <div class="form-elem">
                                                <label for="" class="form-label">Project link</label>
                                                <input name="proj_link" type="text" class="form-control proj_link" id=""
                                                    onkeyup="generateCV()">
                                                <span class="form-text"></span>
                                            </div>
                                            <div class="form-elem">
                                                <label for="" class="form-label">Description</label>
                                                <input name="proj_description" type="text"
                                                    class="form-control proj_description" id="" onkeyup="generateCV()">
                                                <span class="form-text"></span>
                                            </div>
                                        </div>
                                        <button data-repeater-delete type="button"
                                            class="repeater-remove-btn">-</button>
                                    </div>
                                </div>
                            </div>
                            <button type="button" data-repeater-create value="Add" class="repeater-add-btn">+</button>
                        </div>
                    </div>

                    <div class="cv-form-blk">
                        <div class="cv-form-row-title">
                            <h3>skills</h3>
                        </div>

                        <div class="row-separator repeater">
                            <div class="repeater" data-repeater-list="group-e">
                                <div data-repeater-item>
                                    <div class="cv-form-row cv-form-row-skills">
                                        <div class="form-elem">
                                            <label for="" class="form-label">Skill</label>
                                            <input name="skill" type="text" class="form-control skill" id=""
                                                onkeyup="generateCV()">
                                            <span class="form-text"></span>
                                        </div>

                                        <button data-repeater-delete type="button"
                                            class="repeater-remove-btn">-</button>
                                    </div>
                                </div>
                            </div>
                            <button type="button" data-repeater-create value="Add" class="repeater-add-btn">+</button>
                        </div>
                    </div>
                </form>
                <button type="button" id="save-draft-btn" class="btn btn-secondary" style="margin-top: 2rem;">Save
                    Draft</button>
            </div>
        </div>
    </section>

    <section id="preview-sc" class="print_area">
        <div class="container">
            <div class="preview-cnt">
                <div class="preview-cnt-l bg-green text-white">
                    <div class="preview-blk">
                        <div class="preview-image">
                            <img src="" alt="" id="image_dsp">
                        </div>
                        <div class="preview-item preview-item-name">
                            <span class="preview-item-val fw-6" id="fullname_dsp"></span>
                        </div>
                        <div class="preview-item">
                            <span class="preview-item-val text-uppercase fw-6 ls-1" id="designation_dsp"></span>
                        </div>
                    </div>

                    <div class="preview-blk">
                        <div class="preview-blk-title">
                            <h3>about</h3>
                        </div>
                        <div class="preview-blk-list">
                            <div class="preview-item">
                                <span class="preview-item-val" id="phoneno_dsp"></span>
                            </div>
                            <div class="preview-item">
                                <span class="preview-item-val" id="email_dsp"></span>
                            </div>
                            <div class="preview-item">
                                <span class="preview-item-val" id="address_dsp"></span>
                            </div>
                            <div class="preview-item">
                                <span class="preview-item-val" id="summary_dsp"></span>
                            </div>
                        </div>
                    </div>

                    <div class="preview-blk">
                        <div class="preview-blk-title">
                            <h3>skills</h3>
                        </div>
                        <div class="skills-items preview-blk-list" id="skills_dsp">
                            <!-- skills list here -->
                        </div>
                    </div>
                </div>

                <div class="preview-cnt-r bg-white">
                    <div class="preview-blk">
                        <div class="preview-blk-title">
                            <h3>Achievements</h3>
                        </div>
                        <div class="achievements-items preview-blk-list" id="achievements_dsp"></div>
                    </div>

                    <div class="preview-blk">
                        <div class="preview-blk-title">
                            <h3>educations</h3>
                        </div>
                        <div class="educations-items preview-blk-list" id="educations_dsp"></div>
                    </div>

                    <div class="preview-blk">
                        <div class="preview-blk-title">
                            <h3>experiences</h3>
                        </div>
                        <div class="experiences-items preview-blk-list" id="experiences_dsp"></div>
                    </div>

                    <div class="preview-blk">
                        <div class="preview-blk-title">
                            <h3>projects</h3>
                        </div>
                        <div class="projects-items preview-blk-list" id="projects_dsp"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="print-btn-sc">
        <div class="container">
            <button type="button" class="print-btn btn btn-primary" onclick="printCV()">Print CV</button>
        </div>
    </section>




    <!-- jquery cdn -->
    <script src="https://code.jquery.com/jquery-3.6.4.js"
        integrity="sha256-a9jBBRygX1Bh5lt8GZjXDzyOB+bWve9EiO7tROUtj/E=" crossorigin="anonymous"></script>
    <!-- jquery repeater cdn -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.repeater/1.2.1/jquery.repeater.js"
        integrity="sha512-bZAXvpVfp1+9AUHQzekEZaXclsgSlAeEnMJ6LfFAvjqYUVZfcuVXeQoN5LhD7Uw0Jy4NCY9q3kbdEXbwhZUmUQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- custom js -->
    <script src="assets/js/script.js"></script>
    <!-- app js -->
    <script src="assets/js/app.js"></script>
    <!-- AI configuration -->
    <script src="assets/js/ai-config.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDeBC_txgoWzX6QoHdcZJT37RpNZNZNi4g",
            authDomain: "auth-e8dd6.firebaseapp.com",
            projectId: "auth-e8dd6",
            storageBucket: "auth-e8dd6.firebasestorage.app",
            messagingSenderId: "879507667626",
            appId: "1:879507667626:web:9bcf4c47caba9cbbc9aed3",
            measurementId: "G-SD5LRH88ZD"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
    </script>
    <script src="assets/js/navbar-auth.js"></script>
    <script>
        // Authentication check for resume page using existing Firebase instance
        firebase.auth().onAuthStateChanged(function (user) {
            if (!user) {
                // User is not logged in, redirect to login page
                window.location.href = 'log-in.html';
            }
        });

        // AI Achievement Points Generation
        async function generateAchievementPointsWithAI(button) {
            // Get the achievement title from the same row
            const achievementRow = button.closest('.cv-form-row-achievement');
            const titleInput = achievementRow.querySelector('.achieve_title');
            const descriptionInput = achievementRow.querySelector('.achieve_description');

            const achievementTitle = titleInput.value.trim();

            // Validation
            if (!achievementTitle) {
                showNotification('Please enter an achievement title first before generating AI points.', 'error');
                titleInput.focus();
                return;
            }

            // Check if backend is available
            try {
                const healthCheck = await fetch('http://localhost:3000/api/health');
                if (!healthCheck.ok) {
                    showNotification('AI service is not available. Please ensure the backend server is running.', 'error');
                    return;
                }
            } catch (error) {
                showNotification('AI service is not available. Please ensure the backend server is running on port 3000.', 'error');
                return;
            }

            // Store original button text and disable button
            const originalText = button.textContent;
            button.textContent = 'Generating AI points...';
            button.disabled = true;
            button.style.opacity = '0.7';

            try {
                // Show loading state
                const loadingSpinner = document.createElement('span');
                loadingSpinner.innerHTML = ' ⏳';
                button.appendChild(loadingSpinner);

                // Call AI API
                const aiPoints = await generateAchievementPoints(achievementTitle);

                // Remove loading spinner
                button.removeChild(loadingSpinner);

                // Fill the description with AI-generated points
                descriptionInput.value = aiPoints;

                // Auto-resize textarea to fit content
                descriptionInput.style.height = 'auto';
                descriptionInput.style.height = descriptionInput.scrollHeight + 'px';

                // Trigger CV generation to update preview
                generateCV();

                // Show success message
                showNotification('AI points generated! Feel free to edit the content.', 'success');

            } catch (error) {
                console.error('AI Generation Error:', error);

                // Remove loading spinner if it exists
                const spinner = button.querySelector('span');
                if (spinner) {
                    button.removeChild(spinner);
                }

                // Show error message
                let errorMessage = 'Failed to generate AI points. ';
                if (error.message.includes('API request failed: 401')) {
                    errorMessage += 'Invalid API key. Please check your OpenRouter API key.';
                } else if (error.message.includes('API request failed: 429')) {
                    errorMessage += 'Rate limit exceeded. Please try again later.';
                } else if (error.message.includes('fetch')) {
                    errorMessage += 'Network error. Please check your internet connection.';
                } else {
                    errorMessage += 'Please try again.';
                }

                showNotification(errorMessage, 'error');

            } finally {
                // Restore button state
                button.textContent = originalText;
                button.disabled = false;
                button.style.opacity = '1';
            }
        }

        // AI Experience Points Generation
        async function generateExperiencePointsWithAI(button) {
            // Get the experience details from the same row
            const experienceRow = button.closest('.cv-form-row-experience');
            const titleInput = experienceRow.querySelector('.exp_title');
            const organizationInput = experienceRow.querySelector('.exp_organization');
            const descriptionInput = experienceRow.querySelector('.exp_description');

            const expTitle = titleInput.value.trim();
            const expOrganization = organizationInput.value.trim();

            // Validation
            if (!expTitle) {
                showNotification('Please enter a job title first before generating AI points.', 'error');
                titleInput.focus();
                return;
            }

            if (!expOrganization) {
                showNotification('Please enter a company/organization name before generating AI points.', 'error');
                organizationInput.focus();
                return;
            }

            // Check if backend is available
            try {
                const healthCheck = await fetch('http://localhost:3000/api/health');
                if (!healthCheck.ok) {
                    showNotification('AI service is not available. Please ensure the backend server is running.', 'error');
                    return;
                }
            } catch (error) {
                showNotification('AI service is not available. Please ensure the backend server is running on port 3000.', 'error');
                return;
            }

            // Store original button text and disable button
            const originalText = button.textContent;
            button.textContent = 'Generating AI points...';
            button.disabled = true;
            button.style.opacity = '0.7';

            try {
                // Show loading state
                const loadingSpinner = document.createElement('span');
                loadingSpinner.innerHTML = ' ⏳';
                button.appendChild(loadingSpinner);

                // Call AI API
                const aiPoints = await generateExperiencePoints(expTitle, expOrganization);

                // Remove loading spinner
                button.removeChild(loadingSpinner);

                // Fill the description with AI-generated points
                descriptionInput.value = aiPoints;

                // Auto-resize textarea to fit content
                descriptionInput.style.height = 'auto';
                descriptionInput.style.height = descriptionInput.scrollHeight + 'px';

                // Trigger CV generation to update preview
                generateCV();

                // Show success message
                showNotification('AI points generated! Feel free to edit the content.', 'success');

            } catch (error) {
                console.error('AI Generation Error:', error);

                // Remove loading spinner if it exists
                const spinner = button.querySelector('span');
                if (spinner) {
                    button.removeChild(spinner);
                }

                // Show error message
                let errorMessage = 'Failed to generate AI points. ';
                if (error.message.includes('API request failed: 401')) {
                    errorMessage += 'Invalid API key. Please check your OpenRouter API key.';
                } else if (error.message.includes('API request failed: 429')) {
                    errorMessage += 'Rate limit exceeded. Please try again later.';
                } else if (error.message.includes('fetch')) {
                    errorMessage += 'Network error. Please check your internet connection.';
                } else {
                    errorMessage += 'Please try again.';
                }

                showNotification(errorMessage, 'error');

            } finally {
                // Restore button state
                button.textContent = originalText;
                button.disabled = false;
                button.style.opacity = '1';
            }
        }

        // AI Education Points Generation
        async function generateEducationPointsWithAI(button) {
            // Get the education details from the same row
            const educationRow = button.closest('.cv-form-row-experience');
            const schoolInput = educationRow.querySelector('.edu_school');
            const degreeInput = educationRow.querySelector('.edu_degree');
            const descriptionInput = educationRow.querySelector('.edu_description');

            const eduSchool = schoolInput.value.trim();
            const eduDegree = degreeInput.value.trim();

            // Validation
            if (!eduSchool) {
                showNotification('Please enter a school name first before generating AI points.', 'error');
                schoolInput.focus();
                return;
            }

            if (!eduDegree) {
                showNotification('Please enter a degree before generating AI points.', 'error');
                degreeInput.focus();
                return;
            }

            // Check if backend is available
            try {
                const healthCheck = await fetch('http://localhost:3000/api/health');
                if (!healthCheck.ok) {
                    showNotification('AI service is not available. Please ensure the backend server is running.', 'error');
                    return;
                }
            } catch (error) {
                showNotification('AI service is not available. Please ensure the backend server is running on port 3000.', 'error');
                return;
            }

            // Store original button text and disable button
            const originalText = button.textContent;
            button.textContent = 'Generating AI points...';
            button.disabled = true;
            button.style.opacity = '0.7';

            try {
                // Show loading state
                const loadingSpinner = document.createElement('span');
                loadingSpinner.innerHTML = ' ⏳';
                button.appendChild(loadingSpinner);

                // Call AI API
                const aiPoints = await generateEducationPoints(eduSchool, eduDegree);

                // Remove loading spinner
                button.removeChild(loadingSpinner);

                // Fill the description with AI-generated points
                descriptionInput.value = aiPoints;

                // Auto-resize textarea to fit content
                descriptionInput.style.height = 'auto';
                descriptionInput.style.height = descriptionInput.scrollHeight + 'px';

                // Trigger CV generation to update preview
                generateCV();

                // Show success message
                showNotification('AI points generated! Feel free to edit the content.', 'success');

            } catch (error) {
                console.error('AI Generation Error:', error);

                // Remove loading spinner if it exists
                const spinner = button.querySelector('span');
                if (spinner) {
                    button.removeChild(spinner);
                }

                // Show error message
                let errorMessage = 'Failed to generate AI points. ';
                if (error.message.includes('API request failed: 401')) {
                    errorMessage += 'Invalid API key. Please check your OpenRouter API key.';
                } else if (error.message.includes('API request failed: 429')) {
                    errorMessage += 'Rate limit exceeded. Please try again later.';
                } else if (error.message.includes('fetch')) {
                    errorMessage += 'Network error. Please check your internet connection.';
                } else {
                    errorMessage += 'Please try again.';
                }

                showNotification(errorMessage, 'error');

            } finally {
                // Restore button state
                button.textContent = originalText;
                button.disabled = false;
                button.style.opacity = '1';
            }
        }

        // Notification function
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.textContent = message;

            // Play sound based on notification type
            try {
                const audio = new Audio();
                if (type === 'success') {
                    audio.src = 'assets/sounds/success_sound.mp3';
                } else if (type === 'error') {
                    audio.src = 'assets/sounds/error_sound.mp3';
                }
                audio.volume = 0.5; // Set volume to 50%
                audio.play().catch(e => console.log('Audio play failed:', e));
            } catch (error) {
                console.log('Audio not available:', error);
            }

            // Set colors based on notification type
            let backgroundColor, borderColor;
            switch (type) {
                case 'success':
                    backgroundColor = '#4CAF50';
                    borderColor = '#45a049';
                    break;
                case 'error':
                    backgroundColor = '#f44336';
                    borderColor = '#d32f2f';
                    break;
                default:
                    backgroundColor = '#2196F3';
                    borderColor = '#1976D2';
            }

            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: -400px;
                background: ${backgroundColor};
                color: white;
                padding: 16px 24px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                font-size: 1.4rem;
                font-weight: 500;
                z-index: 9999;
                transition: left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                max-width: 350px;
                border-left: 4px solid ${borderColor};
            `;

            document.body.appendChild(notification);

            // Slide in from left
            setTimeout(() => {
                notification.style.left = '20px';
            }, 100);

            // Slide out after 4 seconds
            setTimeout(() => {
                notification.style.left = '-400px';
                setTimeout(() => notification.remove(), 500);
            }, 4000);
        }
    </script>
</body>

</html>